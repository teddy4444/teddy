<!DOCTYPE html>
<html lang="ko">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>ë‚˜ì˜ ì²« ìˆ˜ìµ ë©”ì´íŠ¸ ë§¤ì¹­</title>
Â  Â  <script src="https://cdn.tailwindcss.com"></script>
Â  Â  <style>
Â  Â  Â  Â  @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700;800&display=swap');
Â  Â  Â  Â Â 
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --point-color: #3CCCD4;Â 
Â  Â  Â  Â  Â  Â  --point-secondary: #6366F1;
Â  Â  Â  Â  Â  Â  --bg-white: #FFFFFF;
Â  Â  Â  Â  Â  Â  --btn-bg: rgba(147, 51, 234, 0.1);
Â  Â  Â  Â  Â  Â  --btn-text: #7C3AED;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {Â 
Â  Â  Â  Â  Â  Â  font-family: 'Pretendard', sans-serif;Â 
Â  Â  Â  Â  Â  Â  background-color: #F9FAFB;Â 
Â  Â  Â  Â  Â  Â  color: #1F2937;
Â  Â  Â  Â  Â  Â  display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0;
Â  Â  Â  Â  Â  Â  padding: 1rem;
Â  Â  Â  Â  }

Â  Â  Â  Â  .main-card {
Â  Â  Â  Â  Â  Â  width: 100%; max-width: 440px; height: 720px;Â 
Â  Â  Â  Â  Â  Â  background: var(--bg-white); border-radius: 3rem;
Â  Â  Â  Â  Â  Â  box-shadow: 0 40px 100px -20px rgba(60, 204, 212, 0.15);
Â  Â  Â  Â  Â  Â  display: flex; flex-direction: column;
Â  Â  Â  Â  Â  Â  position: relative; border: 1px solid rgba(60, 204, 212, 0.1);
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }

Â  Â  Â  Â  .step {Â 
Â  Â  Â  Â  Â  Â  display: none; width: 100%; height: 100%;
Â  Â  Â  Â  Â  Â  flex-direction: column; align-items: center; justify-content: center;Â 
Â  Â  Â  Â  Â  Â  text-align: center; padding: 0 2rem;
Â  Â  Â  Â  }
Â  Â  Â  Â  .step.active { display: flex; animation: fadeIn 0.5s ease-out; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #step-2 { justify-content: flex-start; pt-24; padding-top: 11rem; }

Â  Â  Â  Â  @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

Â  Â  Â  Â  .back-btn {
Â  Â  Â  Â  Â  Â  position: absolute; top: 2rem; left: 2rem;
Â  Â  Â  Â  Â  Â  color: #94A3B8; cursor: pointer; transition: all 0.2s ease;
Â  Â  Â  Â  Â  Â  display: none; z-index: 50;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  #progress-container {
Â  Â  Â  Â  Â  Â  position: absolute; top: 5.5rem; left: 0; width: 100%; padding: 0 2.5rem;
Â  Â  Â  Â  Â  Â  z-index: 40;
Â  Â  Â  Â  }

Â  Â  Â  Â  .animated-title {
Â  Â  Â  Â  Â  Â  background: linear-gradient(90deg, #3CCCD4, #6366F1, #3CCCD4);
Â  Â  Â  Â  Â  Â  background-size: 200% auto;
Â  Â  Â  Â  Â  Â  color: transparent; -webkit-background-clip: text; background-clip: text;
Â  Â  Â  Â  Â  Â  animation: gradientMove 4s linear infinite; display: inline-block;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes gradientMove { to { background-position: 200% center; } }

Â  Â  Â  Â  .glass-orb {
Â  Â  Â  Â  Â  Â  width: 160px; height: 160px; border-radius: 50%;
Â  Â  Â  Â  Â  Â  background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 1) 0%, rgba(60, 204, 212, 0.3) 30%, rgba(147, 51, 234, 0.2) 60%, rgba(59, 130, 246, 0.1) 100%);
Â  Â  Â  Â  Â  Â  box-shadow: inset -10px -10px 30px rgba(60, 204, 212, 0.2), inset 10px 10px 30px rgba(255, 255, 255, 0.8), 0 20px 40px rgba(60, 204, 212, 0.1);
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px);
Â  Â  Â  Â  Â  Â  margin-bottom: 2rem; animation: float 4s infinite ease-in-out;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }

Â  Â  Â  Â  .tarot-card {
Â  Â  Â  Â  Â  Â  background: #FFFFFF; border: 2px solid #F3F4F6; border-radius: 1.25rem;
Â  Â  Â  Â  Â  Â  width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;
Â  Â  Â  Â  Â  Â  padding: 1.25rem; cursor: pointer; transition: all 0.2s ease;
Â  Â  Â  Â  }
Â  Â  Â  Â  .tarot-card:hover { border-color: var(--point-color); background: #f0fdfe; transform: translateY(-3px); }
Â  Â  Â  Â  .tarot-card span.emoji { font-size: 1.8rem; margin-bottom: 0.4rem; }
Â  Â  Â  Â  .tarot-card span.label { font-size: 0.9rem; font-weight: 800; color: #4B5563; }

Â  Â  Â  Â  .capsule-button {
Â  Â  Â  Â  Â  Â  background-color: var(--btn-bg); color: var(--btn-text);
Â  Â  Â  Â  Â  Â  border-radius: 9999px; width: 100%; padding: 1rem;
Â  Â  Â  Â  Â  Â  font-weight: 700; font-size: 1.05rem; transition: all 0.2s ease; margin-top: 1.25rem;
Â  Â  Â  Â  }

Â  Â  Â  Â  .best-badge {
Â  Â  Â  Â  Â  Â  background: #3CCCD4; color: white; padding: 4px 12px; border-radius: 20px;
Â  Â  Â  Â  Â  Â  font-size: 11px; font-weight: 800; margin-bottom: 0.75rem; display: inline-block;
Â  Â  Â  Â  }

Â  Â  Â  Â  #progress-bar { transition: width 0.4s ease; background: linear-gradient(90deg, #3CCCD4 0%, #7C3AED 100%); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .choice-summary {Â 
Â  Â  Â  Â  Â  Â  width: 100%; padding: 1.25rem;Â 
Â  Â  Â  Â  Â  Â  margin-top: 0;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  .brand-logo-img {
Â  Â  Â  Â  Â  Â  max-height: 200px;Â 
Â  Â  Â  Â  Â  Â  object-fit: contain;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  animation: float 4s infinite ease-in-out;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  @keyframes btn-glow {
Â  Â  Â  Â  Â  Â  0% { box-shadow: 0 0 0 0 rgba(124, 58, 237, 0.4); }
Â  Â  Â  Â  Â  Â  70% { box-shadow: 0 0 0 12px rgba(124, 58, 237, 0); }
Â  Â  Â  Â  Â  100% { box-shadow: 0 0 0 0 rgba(124, 58, 237, 0); }
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-incentive { animation: btn-glow 2s infinite; }

Â  Â  Â  Â  .loading-dots:after { content: '.'; animation: dots 1.5s steps(5, end) infinite; }
Â  Â  Â  Â  @keyframes dots { 0%, 20% { content: '.'; } 40% { content: '..'; } 60% { content: '...'; } 80%, 100% { content: ''; } }
Â  Â  </style>
</head>
<body>

<div id="app" class="main-card">
Â  Â  <div id="back-button" class="back-btn" onclick="prevStep()">
Â  Â  Â  Â  <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M15 19l-7-7 7-7" />
Â  Â  Â  Â  </svg>
Â  Â  </div>

Â  Â  <div id="progress-container" class="hidden">
Â  Â  Â  Â  <div class="flex justify-between items-center mb-1.5 px-0.5">
Â  Â  Â  Â  Â  Â  <span class="text-[10px] font-bold text-[#3CCCD4] uppercase tracking-widest">ë§¤ì¹­ ì§„í–‰ë¥ </span>
Â  Â  Â  Â  Â  Â  <span id="percent-text" class="text-[10px] font-bold text-[#3CCCD4]">0%</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="w-full bg-gray-100 h-1 rounded-full overflow-hidden">
Â  Â  Â  Â  Â  Â  <div id="progress-bar" class="h-full w-0"></div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="step-0" class="step active">
Â  Â  Â  Â  <div class="flex flex-col items-center py-4">
            <img src="https://github.com/3hatdy/my-assets/blob/main/%E1%84%89%E1%85%A6%E1%84%89%E1%85%B5%E1%84%80%E1%85%A1%E1%86%AB%E1%84%8C%E1%85%A5%E1%86%AB%20%E1%84%85%E1%85%A9%E1%84%80%E1%85%A9%20%E1%84%82%E1%85%AE%E1%84%81%E1%85%B5.png?raw=true" alt="ì„¸ì‹œê°„ì „ ë¡œê³ " class="h-8 mb-6">
            <h1 class="text-[26px] font-black mb-16 animated-title">ë‚˜ì˜ ì²« ìˆ˜ìµ ë©”ì´íŠ¸ ë§¤ì¹­</h1>
Â  Â  Â  Â  Â  Â  <div class="glass-orb"></div>
Â  Â  Â  Â  Â  Â  <p class="text-gray-500 text-[14px] leading-relaxed font-medium px-4 mb-6">ì§€ê¸ˆ ë‚´ê°€ ì‚¬ìš©í•˜ê¸° ë”± ì¢‹ì€<br>ì œíœ´ë§í¬ë¥¼ ì°¾ì•„ë“œë¦´ê²Œìš”.</p>
Â  Â  Â  Â  Â  Â  <button onclick="startTest()" class="capsule-button max-w-[280px]">ì‹œì‘í•˜ê¸° âœ¨</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="step-1" class="step">
Â  Â  Â  Â  <h2 class="text-[22px] font-bold mb-8 text-gray-800 leading-snug">
Â  Â  Â  Â  Â  Â  ì§€ê¸ˆ ë°”ë¡œ í¬ìŠ¤íŒ…í•œë‹¤ë©´ ì£¼ì œëŠ”?<br>
Â  Â  Â  Â  Â  Â  <span class="text-[16px] text-gray-400 font-medium">(ë˜ëŠ” ê¸°ì¡´ í¬ìŠ¤íŒ… ì£¼ì œëŠ”?)</span>
Â  Â  Â  Â  </h2>
Â  Â  Â  Â  <div class="flex flex-col gap-3 w-full max-w-[320px]">
Â  Â  Â  Â  Â  Â  <div onclick="save('q1', 'ì—¬í–‰ í¬ìŠ¤íŒ…', 'âœˆï¸')" class="tarot-card">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="emoji">âœˆï¸</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="label">ì„¤ë ˜ì´ ê°€ë“í–ˆë˜ ì—¬í–‰ê³¼ íœ´ì‹</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div onclick="save('q1', 'ì¼ìƒÂ·ë¦¬ë¹™ í¬ìŠ¤íŒ…', 'ğŸ ')" class="tarot-card">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="emoji">ğŸ </span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="label">ë‚˜ì˜ ì·¨í–¥ì´ ë‹´ê¸´ ê³µê°„ê³¼ ì¼ìƒ</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="step-2" class="step">
Â  Â  Â  Â  <h2 class="text-[22px] font-bold mb-8 text-gray-800">ë‚´ê°€ ìµœê·¼ì— êµ¬ë§¤í•œ ìƒí’ˆì€?</h2>
Â  Â  Â  Â  <div id="q2-container" class="grid grid-cols-2 gap-3 w-full"></div>
Â  Â  </div>

Â  Â  <div id="step-3" class="step">
Â  Â  Â  Â  <h2 class="text-[22px] font-bold mb-8 text-gray-800">ë‚´ ë¸”ë¡œê·¸ëŠ” í•˜ë£¨ í‰ê· <br>ì´ ì •ë„ ë°©ë¬¸í•´ìš”!</h2>
Â  Â  Â  Â  <div class="flex flex-col gap-2.5 w-full max-w-[280px]">
Â  Â  Â  Â  Â  Â  <div onclick="save('q3', '0~300ëª…', 'ğŸŒ±')" class="tarot-card"><span>ğŸŒ±</span><span class="label">0~300ëª…</span></div>
Â  Â  Â  Â  Â  Â  <div onclick="save('q3', '300~2,000ëª…', 'ğŸŒ¿')" class="tarot-card"><span>ğŸŒ¿</span><span class="label">300~2,000ëª…</span></div>
Â  Â  Â  Â  Â  Â  <div onclick="save('q3', '2,000ëª… ì´ìƒ', 'ğŸŒ³')" class="tarot-card"><span>ğŸŒ³</span><span class="label">2,000ëª… ì´ìƒ</span></div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="step-loading" class="step">
Â  Â  Â  Â  <div class="glass-orb scale-75 mb-4"></div>
Â  Â  Â  Â  <h2 class="text-[20px] font-bold text-gray-800 animated-title">
Â  Â  Â  Â  Â  Â  ë°ì´í„° ë¶„ì„ ì¤‘<span class="loading-dots"></span><br>
Â  Â  Â  Â  Â  Â  <span class="text-[13px] font-medium text-gray-500 mt-2 block">ê°€ì¥ ì•Œë§ì€ ì œíœ´ë§í¬ë¥¼ ì°¾ëŠ” ì¤‘ì…ë‹ˆë‹¤</span>
Â  Â  Â  Â  </h2>
Â  Â  </div>

Â  Â  <div id="step-result" class="step">
Â  Â  Â  Â  <div class="flex flex-col items-center w-full py-2">Â 
Â  Â  Â  Â  Â  Â  <div class="w-full mb-0">Â 
Â  Â  Â  Â  Â  Â  Â  Â  <div class="best-badge">ìŠ¤íƒ€í„° ë“±ê¸‰ ìµœê³  ìˆ˜ìˆ˜ë£Œìœ¨ ì§€ê¸‰ âœ¨</div>
Â  Â  Â  Â  Â  Â  Â  Â  <h2 id="final-brand-main" class="text-[48px] font-black mb-2 text-gray-900 tracking-tighter leading-tight"></h2>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="mb-0">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img id="final-brand-logo" src="" alt="ì œíœ´ì‚¬ ë¡œê³ " class="brand-logo-img">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="choice-summary mb-2 mt-0">
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-[16px] font-black text-[#3CCCD4] uppercase mb-1.5">ë‚˜ì˜ ì„ íƒ ë¦¬í¬íŠ¸</p>
Â  Â  Â  Â  Â  Â  Â  Â  <p id="user-review" class="text-[14px] font-semibold text-gray-600 leading-relaxed px-1"></p>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-3 gap-2.5 w-full mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-gray-50 py-3 rounded-xl border border-gray-100">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-[9px] text-gray-400 font-bold mb-1 uppercase">ìˆ˜ìˆ˜ë£Œìœ¨</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p id="result-rate" class="font-extrabold text-[#3CCCD4] text-base"></p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-gray-50 py-3 rounded-xl border border-gray-100">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-[9px] text-gray-400 font-bold mb-1 uppercase">ìˆ˜ìµì„±</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="font-extrabold text-[#3CCCD4] text-base">ìµœìƒ</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="bg-gray-50 py-3 rounded-xl border border-gray-100">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-[9px] text-gray-400 font-bold mb-1 uppercase">ì‹ ë¢°ë„</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p id="match-rate" class="font-extrabold text-[#3CCCD4] text-base"></p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <button id="result-link-btn" onclick="goToLandingPage()" class="capsule-button max-w-[300px] mb-4 btn-incentive">ì œíœ´ë§í¬ ìƒì„±í•˜ëŸ¬ ê°€ê¸° ğŸ”—</button>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<script>
Â  Â  const urlParams = new URLSearchParams(window.location.search);
Â  Â  const aid = urlParams.get('aid') || 'direct';

Â  Â  let answers = {};
Â  Â  let currentStepIndex = 0;
Â  Â  let finalLandingUrl = "";

Â  Â  const q2Options = {
Â  Â  Â  Â  'ì—¬í–‰ í¬ìŠ¤íŒ…': [
Â  Â  Â  Â  Â  Â  { text: 'ìˆ™ì†Œ', icon: 'ğŸ¨' }, { text: 'í•­ê³µê¶Œ', icon: 'âœˆï¸' },
Â  Â  Â  Â  Â  Â  { text: 'e-sim', icon: 'ğŸ“±' }, { text: 'ì•¡í‹°ë¹„í‹°/íˆ¬ì–´', icon: 'ğŸ¡' },
Â  Â  Â  Â  Â  Â  { text: 'ë Œí„°ì¹´', icon: 'ğŸš—' }
Â  Â  Â  Â  ],
Â  Â  Â  Â  'ì¼ìƒÂ·ë¦¬ë¹™ í¬ìŠ¤íŒ…': [
Â  Â  Â  Â  Â  Â  { text: 'ì†Œí’ˆ', icon: 'ğŸ•¯ï¸' }, { text: 'ê°€êµ¬', icon: 'ğŸ›‹ï¸' },
Â  Â  Â  Â  Â  Â  { text: 'ê°€ì „', icon: 'ğŸ“º' }, { text: 'ì¸í…Œë¦¬ì–´', icon: 'ğŸ–¼ï¸' }
Â  Â  Â  Â  ]
Â  Â  };

Â  Â  const affiliateMapping = {
Â  Â  Â  Â  'ìˆ™ì†Œ': { brand: 'ì•„ê³ ë‹¤', rate: 'ìµœëŒ€ 2.4%', logo: 'https://raw.githubusercontent.com/teddy4444/my-assets/main/Group%206905.png', url: 'https://3hoursahead.com/studio/affiliate/programs/agoda' },
Â  Â  Â  Â  'í•­ê³µê¶Œ': { brand: 'íŠ¸ë¦½ë‹·ì»´', rate: 'ìµœëŒ€ 0.9%', logo: 'https://raw.githubusercontent.com/teddy4444/my-assets/main/Group%206688.png', url: 'https://3hoursahead.com/studio/affiliate/programs/tripcom' },
Â  Â  Â  Â  'e-sim': { brand: 'ìœ ì‹¬ì‚¬', rate: 'ìµœëŒ€ 6%', logo: 'https://raw.githubusercontent.com/teddy4444/my-assets/main/Group%206909.png', url: 'https://3hoursahead.com/studio/affiliate/programs/usimsa' },
Â  Â  Â  Â  'ì•¡í‹°ë¹„í‹°/íˆ¬ì–´': { brand: 'ë§ˆì´ë¦¬ì–¼íŠ¸ë¦½', rate: 'ìµœëŒ€ 6%', logo: 'https://raw.githubusercontent.com/teddy4444/my-assets/main/Group%206907.png', url: 'https://3hoursahead.com/studio/affiliate/programs/myrealtrip' },
Â  Â  Â  Â  'ë Œí„°ì¹´': { brand: 'í´ë£©', rate: 'ìµœëŒ€ 3%', logo: 'https://raw.githubusercontent.com/teddy4444/my-assets/main/Group%206696.png', url: 'https://3hoursahead.com/studio/affiliate/programs/klook' },
Â  Â  Â  Â  'ì†Œí’ˆ': { brand: 'ì˜¤ëŠ˜ì˜ì§‘', rate: 'ìµœëŒ€ 2.5%', logo: 'https://raw.githubusercontent.com/teddy4444/my-assets/main/Group%206692.png', url: 'https://3hoursahead.com/studio/affiliate/programs/linkprice_ohouse' },
Â  Â  Â  Â  'ê°€êµ¬': { brand: 'ì˜¤ëŠ˜ì˜ì§‘', rate: 'ìµœëŒ€ 2.5%', logo: 'https://raw.githubusercontent.com/teddy4444/my-assets/main/Group%206692.png', url: 'https://3hoursahead.com/studio/affiliate/programs/linkprice_ohouse' },
Â  Â  Â  Â  'ê°€ì „': { brand: 'ì˜¤ëŠ˜ì˜ì§‘', rate: '2.5%', logo: 'https://raw.githubusercontent.com/teddy4444/my-assets/main/Group%206692.png', url: 'https://3hoursahead.com/studio/affiliate/programs/linkprice_ohouse' },
Â  Â  Â  Â  'ì¸í…Œë¦¬ì–´': { brand: 'ì˜¤ëŠ˜ì˜ì§‘', rate: 'ìµœëŒ€ 2.5%', logo: 'https://raw.githubusercontent.com/teddy4444/my-assets/main/Group%206692.png', url: 'https://3hoursahead.com/studio/affiliate/programs/linkprice_ohouse' }
Â  Â  };

Â  Â  function startTest() {Â 
Â  Â  Â  Â  document.getElementById('progress-container').classList.remove('hidden');Â 
Â  Â  Â  Â  nextStep(1);Â 
Â  Â  }
Â  Â Â 
Â  Â  function nextStep(n) {
Â  Â  Â  Â  currentStepIndex = n;
Â  Â  Â  Â  document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
Â  Â  Â  Â  const backBtn = document.getElementById('back-button');
Â  Â  Â  Â  const progressContainer = document.getElementById('progress-container');

Â  Â  Â  Â  backBtn.style.display = (n >= 1 && n <= 3) ? 'block' : 'none';
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (n === 'result' || n === 0) {
Â  Â  Â  Â  Â  Â  progressContainer.classList.add('hidden');
Â  Â  Â  Â  }

Â  Â  Â  Â  if (n === 2) renderQ2();
Â  Â  Â  Â Â 
Â  Â  Â  Â  let targetId = (n === 'loading') ? 'step-loading' : (n === 'result' ? 'step-result' : 'step-' + n);
Â  Â  Â  Â  document.getElementById(targetId).classList.add('active');
Â  Â  Â  Â Â 
Â  Â  Â  Â  const progressMap = { 0: 0, 1: 25, 2: 50, 3: 75, 'loading': 90, 'result': 100 };
Â  Â  Â  Â  document.getElementById('progress-bar').style.width = (progressMap[n] || 0) + '%';
Â  Â  Â  Â  document.getElementById('percent-text').innerText = (progressMap[n] || 0) + '%';
Â  Â  }

Â  Â  function renderQ2() {
Â  Â  Â  Â  const container = document.getElementById('q2-container');
Â  Â  Â  Â  container.innerHTML = '';
Â  Â  Â  Â  const selectedMemory = answers.q1.text;
Â  Â  Â  Â  q2Options[selectedMemory].forEach(opt => {
Â  Â  Â  Â  Â  Â  const div = document.createElement('div');
Â  Â  Â  Â  Â  Â  div.className = 'tarot-card';
Â  Â  Â  Â  Â  Â  div.onclick = () => save('q2', opt.text, opt.icon);
Â  Â  Â  Â  Â  Â  div.innerHTML = `<span class="emoji">${opt.icon}</span><span class="label">${opt.text}</span>`;
Â  Â  Â  Â  Â  Â  container.appendChild(div);
Â  Â  Â  Â  });
Â  Â  }

Â  Â  function prevStep() {
Â  Â  Â  Â  if (currentStepIndex === 1) { nextStep(0); }
Â  Â  Â  Â  else if (currentStepIndex > 1) { nextStep(currentStepIndex - 1); }
Â  Â  }

Â  Â  function save(q, val, icon) {
Â  Â  Â  Â  answers[q] = { text: val, icon: icon };
Â  Â  Â  Â  const cur = parseInt(q.charAt(1));
Â  Â  Â  Â  if (cur < 3) nextStep(cur + 1);
Â  Â  Â  Â  else { nextStep('loading'); setTimeout(() => calculate(), 1800); }
Â  Â  }

Â  Â  function calculate() {
Â  Â  Â  Â  const result = affiliateMapping[answers.q2.text];
Â  Â  Â  Â  document.getElementById('final-brand-main').innerText = result.brand;
Â  Â  Â  Â  document.getElementById('result-rate').innerText = result.rate;
Â  Â  Â  Â  document.getElementById('final-brand-logo').src = result.logo;
Â  Â  Â  Â Â 
Â  Â  Â  Â  const selectedProduct = answers.q2.text;
Â  Â  Â  Â  const selectedVisitors = answers.q3.text;
Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById('user-review').innerHTML =Â 
Â  Â  Â  Â  Â  Â  `ìµœê·¼ì— <span class="text-gray-900 font-bold">${answers.q2.icon} ${selectedProduct}</span>ì„(ë¥¼) ì´ìš©í•˜ì…¨êµ°ìš”!<br>` +
Â  Â  Â  Â  Â  Â  `ì§€ê¸ˆ ë‚´ ë¸”ë¡œê·¸ ê·œëª¨ <span class="text-gray-900 font-bold">${selectedVisitors}</span>ì—<br>` +
Â  Â  Â  Â  Â  Â  `ë”± ë§ëŠ” ì œíœ´ í”„ë¡œê·¸ë¨ì€ <span class="text-gray-900 font-bold">${result.brand}</span>ì…ë‹ˆë‹¤.`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  document.getElementById('match-rate').innerText = (Math.floor(Math.random() * 15) + 85) + '%';
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ê²°ê³¼ ì¶”ì  íŒŒë¼ë¯¸í„° êµ¬ì„±
Â  Â  Â  Â  const queryParams = new URLSearchParams({
Â  Â  Â  Â  Â  Â  aid: aid,
Â  Â  Â  Â  Â  Â  topic: answers.q1.text,
Â  Â  Â  Â  Â  Â  product: selectedProduct,
Â  Â  Â  Â  Â  Â  visitors: selectedVisitors,
Â  Â  Â  Â  Â  Â  brand: result.brand
Â  Â  Â  Â  }).toString();
Â  Â  Â  Â Â 
Â  Â  Â  Â  finalLandingUrl = `${result.url}?${queryParams}`;
Â  Â  Â  Â Â 
Â  Â  Â  Â  nextStep('result');
Â  Â  }

Â  Â  function goToLandingPage() {
Â  Â  Â  Â  if (finalLandingUrl) {
Â  Â  Â  Â  Â  Â  window.location.href = finalLandingUrl;
Â  Â  Â  Â  }
Â  Â  }
</script>
</body>
</html>
